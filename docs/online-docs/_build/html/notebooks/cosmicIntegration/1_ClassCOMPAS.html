

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>The COMPAS class &mdash; COMPAS  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/COMPAS.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The MSSFR class" href="2_MSSFR-or-SFRD-prescriptions.html" />
    <link rel="prev" title="Cosmic integration" href="../../post-processing-cosmic-integration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> COMPAS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user-guide.html">User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../program-options.html">Program options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../grid-files.html">Grid files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../random-seed.html">Random seed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../running-via-cmdline.html">Running COMPAS from the command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../running-via-python.html">Running COMPAS via Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../running-via-docker.html">Running COMPAS via Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../output.html">COMPAS Output</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../post-processing.html">Post-processing tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../post-processing-python-basics.html">Some Python basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../post-processing-hdf5.html">Processing HDF5 files</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../post-processing-cosmic-integration.html">Cosmic integration</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Class COMPAS: setting the data.</a></li>
<li class="toctree-l4"><a class="reference internal" href="2_MSSFR-or-SFRD-prescriptions.html">Class MSSFR: choose a model and plot it.</a></li>
<li class="toctree-l4"><a class="reference internal" href="3_SelectionEffects.html">Selection effects module: choose the sensitivity and estimate detection probability.</a></li>
<li class="toctree-l4"><a class="reference internal" href="4_MergersAtSingleRedshift.html">Rate at a single redshift: combine data, MSSFR, and selection effects.</a></li>
<li class="toctree-l4"><a class="reference internal" href="5_MergersAsFunctionOfRedhisft.html">Class CosmicIntegrator: rate as a function of redshift.</a></li>
<li class="toctree-l4"><a class="reference internal" href="6_FastCosmicIntegrator.html">Fast cosmic integration module: do it all in one go!</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../example-compas-run.html">Tutorial: simple COMPAS run</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-guide.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/TeamCOMPAS/COMPAS"> Code repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/TeamCOMPAS/COMPAS/issues/new"> Request an enhancement</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/TeamCOMPAS/COMPAS/issues/new"> Report a problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact-us.html">Contact us</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">COMPAS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../user-guide.html">User guide</a> &raquo;</li>
        
          <li><a href="../../post-processing.html">Post-processing tools</a> &raquo;</li>
        
          <li><a href="../../post-processing-cosmic-integration.html">Cosmic integration</a> &raquo;</li>
        
      <li>The COMPAS class</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="The-COMPAS-class">
<h1>The COMPAS class<a class="headerlink" href="#The-COMPAS-class" title="Permalink to this headline">¶</a></h1>
<div class="section" id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Permalink to this headline">¶</a></h2>
<p>In order to calculate the formation rate of a type of double compact object at a given redshift, we need to know:</p>
<ol class="arabic simple">
<li><p>The grid of metallicities we assume for the integral</p></li>
<li><p>The amount of solar mass evolved per metallicity per system <span class="math notranslate nohighlight">\(\frac{d}{dM_\odot}(Z)\)</span></p></li>
<li><p>The type of double compact object (DCO) we are interested in</p></li>
<li><p>The metallicity <span class="math notranslate nohighlight">\(Z\)</span> at which each DCO formed and the delay time (time from formation till merger) <span class="math notranslate nohighlight">\(t_c\)</span> for each DCO</p></li>
</ol>
<p>Given a time at which the DCO merges, we can then calculate the time at which it formed, so we can recover the MSSFR (<span class="math notranslate nohighlight">\(\frac{dM_\odot}{dt}\)</span>).</p>
<p>In addition, we need to know the component masses of the system in order to calculate any selection effects.</p>
<p>The COMPAS class (ClassCOMPAS.py) stores the information that we need, and provides quick access when calculating the rates.</p>
<div class="section" id="1.1-Paths">
<h3>1.1 Paths<a class="headerlink" href="#1.1-Paths" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">pathNoteBook</span>     <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">pathClassCOMPAS</span>  <span class="o">=</span> <span class="n">pathNoteBook</span> <span class="o">+</span> <span class="s1">&#39;/PythonScripts/&#39;</span>
<span class="n">pathData</span>         <span class="o">=</span> <span class="s1">&#39;/path-to-data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1.2-Imports">
<h3>1.2 Imports<a class="headerlink" href="#1.2-Imports" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pathClassCOMPAS</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">ClassCOMPAS</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="2.-Creating-an-instance-of-the-COMPAS-class">
<h2>2. Creating an instance of the COMPAS class<a class="headerlink" href="#2.-Creating-an-instance-of-the-COMPAS-class" title="Permalink to this headline">¶</a></h2>
<p>To create an instance of the COMPAS output class, we need to specify the following attributes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>path           = &#39;../&#39;
fileName       = &#39;COMPAS_Output.h5&#39;

lazyData       = True

Mlower         = None
Mupper         = None

binaryFraction = None
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">path</span></code></p>
<p>Path to the h5-data.</p>
<p><code class="docutils literal notranslate"><span class="pre">fileName</span></code></p>
<p>Name of the h5 data</p>
<p><code class="docutils literal notranslate"><span class="pre">lazyData</span></code></p>
<p>Indicates we store additional info like the mass ratios, chirpmasses of each DCO system. In principle this could be done externally, but this is slightly easier when plotting/combining info later on (but it does use more memory).</p>
<p><code class="docutils literal notranslate"><span class="pre">Mlower</span></code></p>
<p>Lower limit used for <span class="math notranslate nohighlight">\(M_1\)</span> in the pythonSubmit of the simulation. Required to recover `true’ amount of <span class="math notranslate nohighlight">\(M_{\odot}\)</span> evolved (see step 4)</p>
<p><code class="docutils literal notranslate"><span class="pre">Mupper</span></code></p>
<p>Upper limit used for <span class="math notranslate nohighlight">\(M_1\)</span> in the pythonSubmit of the simulation. Required to recover `true’ amount of <span class="math notranslate nohighlight">\(M_{\odot}\)</span> evolved (see step 4)</p>
<p><code class="docutils literal notranslate"><span class="pre">binaryFraction</span></code></p>
<p>Assumed fraction of stars in binaries. Required to recover `true’ amount of <span class="math notranslate nohighlight">\(M_{\odot}\)</span> evolved (see step 4)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#I assume all the defaults and just set the path</span>
<span class="n">COMPASData</span> <span class="o">=</span> <span class="n">ClassCOMPAS</span><span class="o">.</span><span class="n">COMPASData</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">pathData</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

ClassCOMPAS: Remember to self.setCOMPASDCOmask()
                    then self.setCOMPASData()
          and optionally self.setGridAndMassEvolved() if using a metallicity grid
</pre></div></div>
</div>
<p>The output are reminders which will be explained in next steps.</p>
</div>
<div class="section" id="3.-Total-mass-evolved">
<h2>3. Total mass evolved<a class="headerlink" href="#3.-Total-mass-evolved" title="Permalink to this headline">¶</a></h2>
<p>In a COMPAS simulation we often only evolve massive stars. This means that the total mass in our simulation does not represent the total mass evolved in all stars. Here we recover an estimate of what that total mass is using the lower and upper mass for the primary from your program options (via the command line or a python submit file), and assuming a binary fraction.</p>
<p>The code will then check your data, and test per metallicity how much mass is evolved. It assumes the metallicities are subject to the same program options, but maybe due to sampling had a different number of systems. It also recovers from the data what metallicity grid is used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">COMPASData</span><span class="o">.</span><span class="n">Mlower</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">COMPASData</span><span class="o">.</span><span class="n">Mupper</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">COMPASData</span><span class="o">.</span><span class="n">binaryFraction</span> <span class="o">=</span><span class="mf">0.7</span>

<span class="n">COMPASData</span><span class="o">.</span><span class="n">setGridAndMassEvolved</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.1-The-grid-of-metallicities-we-assume-for-the-integral">
<h2>3.1 The grid of metallicities we assume for the integral<a class="headerlink" href="#3.1-The-grid-of-metallicities-we-assume-for-the-integral" title="Permalink to this headline">¶</a></h2>
<p>By default, the COMPAS class will automatically try to recover the metallicity grid from the data. It assumes that metallicities of all the systems in the h5-data represent the assumed metallicity grid for the calculation.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>metallicities        = Data[&#39;BSE_System_Parameters&#39;][&#39;Metallicity@ZAMS(1)&#39;][()]
self.metallicityGrid = np.unique(metallicities)
</pre></div>
</div>
<p>In principle you could instead overwrite this with your own metallicity grid: remember to reassign the metallicities of each DCO and the amount of solar mass evolved per metallicity.</p>
<p>However, we leave it at that for now. You can access the grid by printing:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">COMPASData</span><span class="o">.</span><span class="n">metallicityGrid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

[0.00142]
</pre></div></div>
</div>
</div>
<div class="section" id="4.-The-amount-of-solar-mass-evolved-per-system-per-Z">
<h2>4. The amount of solar mass evolved per system per Z<a class="headerlink" href="#4.-The-amount-of-solar-mass-evolved-per-system-per-Z" title="Permalink to this headline">¶</a></h2>
<p>Again, by default, the COMPAS class will automatically recover the amount of ‘true’ solar mass evolved per system using the <code class="docutils literal notranslate"><span class="pre">totalMassEvolvedPerZ</span></code> script, and by reading the total mass per system in the simulation. This recovers an amount of solar mass per metallicity of the metallicity grid (units <span class="math notranslate nohighlight">\(M_{\odot}\)</span>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">COMPASData</span><span class="o">.</span><span class="n">totalMassEvolvedPerZ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

[423202.1360283]
</pre></div></div>
</div>
</div>
<div class="section" id="5.-Selecting-the-DCO-type-of-interest">
<h2>5. Selecting the DCO type of interest<a class="headerlink" href="#5.-Selecting-the-DCO-type-of-interest" title="Permalink to this headline">¶</a></h2>
<p>We use a boolean mask to recover the metallicities, delay times, and other parameters, of the DCOs of interest. The boolean mask, which has the same length as the DCO h5 group, selects the systems we want to include in the calculation.</p>
<p>You could set your own mask using any combination you want by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>maskDCO = some criteria you like on the h5 data
COMPASData.DCOmask = maskDCO
</pre></div>
</div>
<p>However, we are usually interested in a specific group of merging DCOs, assuming a type of physics. The <code class="docutils literal notranslate"><span class="pre">setCOMPASDCOmask()</span></code> function allows you to quickly set the mask without doing the slicing yourself, and takes the following arguments:</p>
<p><code class="docutils literal notranslate"><span class="pre">types</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Type of double compact object (DCO) to mask for.
One of: {&#39;BBH&#39;, &#39;BNS&#39;, &#39;BHNS&#39;, &#39;CHE_BBH&#39;, &#39;NON_CHE_BBH&#39;, &#39;All&#39;}, default = &#39;BBH&#39;

&#39;BBH&#39; masks for all binary black holes.
&#39;CHE_BBH&#39; masks for only those BBHs where both constituent stars evolved as CH stars for their entire MS lifetime.
&#39;NON_CHE_BBH&#39; masks for only those BBHs where one or both constituent stars did not evolve as CH stars for their entire MS lifetime.
&#39;BNS&#39; masks for all binary neutron stars.
&#39;BHNS&#39; masks for all black hole - neutron star binaries.
&#39;All&#39; masks for BBHs (both CHE and NON-CHE), BNSs, and BHNSs.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">withinHubbleTime</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>One of: {True, False}, default = True
If True, only use DCOs that merge within a Hubble time.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pessimistic</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>One of: {True, False}, default = True
If True, mask out DCOs that have formed through a common-envelope event involving a Hertzsprung-gap donor.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">noRLOFafterCEE</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>One of: {True, False}, default = True
If True, mask out DCOs that have at some point experienced RLOF immediately after a common-envelope event.
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">COMPASData</span><span class="o">.</span><span class="n">setCOMPASDCOmask</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="s1">&#39;BBH&#39;</span><span class="p">,</span> <span class="n">pessimistic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Check if we have any system meeting the criteria</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nr systems =</span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">COMPASData</span><span class="o">.</span><span class="n">DCOmask</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

nr systems =19
</pre></div></div>
</div>
</div>
<div class="section" id="6.-Get-the-metallicities-and-delay-times">
<h2>6. Get the metallicities and delay times<a class="headerlink" href="#6.-Get-the-metallicities-and-delay-times" title="Permalink to this headline">¶</a></h2>
<p>Using the DCO mask defined in step 3, the class can now get the parameters of interest for each merging DCO:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">COMPASData</span><span class="o">.</span><span class="n">setCOMPASData</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now the data is set and you are ready to go.</p>
</div>
<div class="section" id="7.-For-different-data">
<h2>7. For different data<a class="headerlink" href="#7.-For-different-data" title="Permalink to this headline">¶</a></h2>
<p>If you have your own simulation which is different from the COMPAS data, or you want to test a toy model, you can still use the set of pipelines for the cosmic integration.</p>
<p>The only thing you need to do is construct your own arrays.</p>
<p>Create an instance of the clasCOMPAS without a path:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">MockData</span> <span class="o">=</span> <span class="n">ClassCOMPAS</span><span class="o">.</span><span class="n">COMPASData</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Just to double check you create instance of ClassCOMPAS without path/Data
ClassCOMPAS: Remember to self.setCOMPASDCOmask()
                    then self.setCOMPASData()
          and optionally self.setGridAndMassEvolved() if using a metallicity grid
</pre></div></div>
</div>
<p>Then manually set each array for:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#grid for integral
MockData.metallicityGrid
MockData.totalMassEvolvedPerZ #same length array as grid

#Metallicity of each system corresponding to a grid-point
MockData.metallicitySystems
MockData.delayTimes  #Myr
MockData.mass1       #Msun
MockData.mass2       #Msun
#All four arrays are same length since they correspond to number of systems
</pre></div>
</div>
<p>All other pipelines just read arrays and are independent of the data.</p>
<p>So you could sample from the IMF for <span class="math notranslate nohighlight">\(M_1\)</span> and <span class="math notranslate nohighlight">\(M_2\)</span>, create a grid in metallicities and uniformly sample from the grid, and then sample from a <span class="math notranslate nohighlight">\(t^{-1}\)</span> delay time distribution (just note the assumed units :))</p>
<p>If you then set <code class="docutils literal notranslate"><span class="pre">totalMassEvolvedperZ</span></code> to an array of ones, you can at least create predictions for the shape of the merger rate distributions - since this array is only a normalization affecting the absolute rates.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="2_MSSFR-or-SFRD-prescriptions.html" class="btn btn-neutral float-right" title="The MSSFR class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../../post-processing-cosmic-integration.html" class="btn btn-neutral float-left" title="Cosmic integration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, The Authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>